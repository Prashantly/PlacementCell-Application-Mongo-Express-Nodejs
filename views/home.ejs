<link rel="stylesheet" href="/css/home.css" />

<div class="container mt-5">
  <div class="row">
    <div class="col-md-6">
      <!-- Student List -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Student List</h3>
        </div>
        <div class="card-body">
          <div class="accordion" id="studentAccordion">
            <% for(student of all_students) {%>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button
                  class="accordion-button collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#student<%= student._id %>Collapse"
                  aria-expanded="false"
                  aria-controls="student<%= student._id %>Collapse"
                >
                  <span class="fw-semibold text-capitalize"
                    ><%= student.name %></span
                  >
                </button>
              </h2>
              <div
                id="student<%= student._id %>Collapse"
                class="accordion-collapse collapse"
                data-bs-parent="#studentAccordion"
              >
                <div class="accordion-body">
                  <p><strong>Name:</strong> <%= student.name %></p>
                  <p><strong>Email:</strong> <%= student.email %></p>
                  <p><strong>College:</strong> <%= student.college %></p>
                  <p><strong>Batch:</strong> <%= student.batch %></p>
                  <p>
                    <strong>Status:</strong> <%= student.placement_status %>
                  </p>
                  <p>
                    <strong>DSA Final Score:</strong> <%=
                    student.courseScores.dsaFinalScore %>%
                  </p>
                  <p>
                    <strong>Web Development Final Score:</strong> <%=
                    student.courseScores.webDFinalScore %>%
                  </p>
                  <p>
                    <strong>React Final Score:</strong> <%=
                    student.courseScores.reactFinalScore %>%
                  </p>
                </div>
              </div>
            </div>
            <%}%>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <!-- Interview List -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Interview List</h3>
        </div>
        <div class="card-body">
          <div class="accordion" id="interviewAccordion">
            <% for(interview of all_interviews) { %>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button
                  class="accordion-button collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#interview<%= interview._id %>Collapse"
                  aria-expanded="false"
                  aria-controls="interview<%= interview._id %>Collapse"
                >
                  <span class="fw-bold text-capitalize"
                    ><%= interview.company %></span
                  >
                </button>
              </h2>
              <div
                id="interview<%= interview._id %>Collapse"
                class="accordion-collapse collapse"
                data-bs-parent="#interviewAccordion"
              >
                <div class="accordion-body">
                  <table class="table">
                    <tbody>
                      <tr>
                        <th scope="row">Company</th>
                        <td><%= interview.company %></td>
                      </tr>
                      <tr>
                        <th scope="col">Date</th>
                        <td><%= interview.date %></td>
                      </tr>
                    </tbody>
                  </table>

                  <!-- Display name, email, and result -->
                  <% for (allocatedStudent of interview.students) { %>
                  <h4>Allocated Student:</h4>
                  <table class="table">
                    <tbody>
                      <tr>
                        <th scope="row">Name</th>
                        <td><%= allocatedStudent.student.name %></td>
                      </tr>
                      <tr>
                        <th scope="row">Email</th>
                        <td><%= allocatedStudent.student.email %></td>
                      </tr>
                      <tr>
                        <th scope="row">Result</th>
                        <td><%= allocatedStudent.result %></td>
                      </tr>
                    </tbody>
                  </table>
                  <% } %>

                  <!-- form to allocate student -->
                  <h4>Allocate Student:</h4>
                  <form
                    action="/interviews/allocate-student/<%=interview._id%>"
                    method="POST"
                  >
                    <div class="mb-3">
                      <label for="student" class="form-label"
                        >Select Student:</label
                      >
                      <select
                        name="student"
                        id="student"
                        class="form-select"
                        required
                      >
                        <% for (student of all_students) { %>
                        <option value="<%= student._id %>">
                          <%= student.name %>
                        </option>
                        <% } %>
                      </select>
                    </div>
                    <div class="mb-3">
                      <label for="result" class="form-label">Result:</label>
                      <select
                        name="result"
                        id="result"
                        class="form-select"
                        required
                      >
                        <option value="Pass">PASS</option>
                        <option value="Fail">FAIL</option>
                        <option value="On Hold">On Hold</option>
                        <option value="Didn't Attempt">Didn't Attempt</option>
                      </select>
                    </div>
                    <button type="submit" class="btn btn-primary">
                      Allocate
                    </button>
                  </form>
                </div>
              </div>
            </div>
            <%}%>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
